--3a)--
SELECT Title FROM Book
WHERE Price < 10;

--3b)--
SELECT title, Initial_date FROM (Book JOIN Txn ON Txn.Transaction_id=Book.Transaction_id) NATURAL JOIN (Customer NATURAL JOIN Buys)
WHERE Customer_id = [QUERY];

--3c)--
SELECT title, ISBN FROM BOOK
GROUP BY ISBN
HAVING COUNT(ISBN) < 5;

--3d)--
SELECT Name, Customer_id FROM (Book JOIN Txn ON Txn.Transaction_id=Book.Transaction_id) NATURAL JOIN (Customer NATURAL JOIN Buys)
WHERE Authors LIKE '%Pratchett';

--3e)--
SELECT COUNT(ISBN) FROM (Book JOIN Txn ON Txn.Transaction_id=Book.Transaction_id) NATURAL JOIN (Customer NATURAL JOIN Buys)
WHERE Customer_id = [QUERY];

--3f)--
CREATE VIEW Customer_Purchase AS
SELECT Name, Customer_id, COUNT(Buys.ISBN) as Book_count FROM (Book JOIN Txn ON Txn.Transaction_id=Book.Transaction_id) NATURAL JOIN (Customer NATURAL JOIN Buys)
GROUP BY Customer_id;

SELECT Name, Customer_id, Book_count FROM Customer_Purchase
WHERE Book_count = (SELECT MAX(Book_count) FROM Customer_Purchase);